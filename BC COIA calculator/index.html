<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Court Order Interest Calculator</title>
    <link rel="stylesheet" href="styles.css">
    <script type="importmap">
    {
      "imports": {
        "zustand": "https://esm.sh/zustand@4.4.1"
      }
    }
    </script>
</head>
<body>
    <div class="paper">

        <h1><i>Court Order Interest Act</i> Calculations</h1>

        <div class="editable-fields-section">
            <!-- Top row with Jurisdiction and Prejudgment checkbox -->
            <div class="field-row">
                <div class="checkbox-container left">
                    <input type="checkbox" data-input="showPrejudgmentCheckbox" id="showPrejudgmentCheckbox" checked>
                    <label for="showPrejudgmentCheckbox">Show prejudgment interest</label>
                </div>
                <div class="right-field">
                    <span class="label">Jurisdiction</span>
                    <span class="value">
                        <select data-input="jurisdictionSelect">
                            <option value="BC" selected>British Columbia</option>
                            <option value="ON">Ontario</option>
                            <option value="AB">Alberta</option>
                            <!-- Add other jurisdictions as needed -->
                        </select>
                    </span>
                </div>
            </div>
            
            <!-- Second row with File No and Postjudgment checkbox -->
            <div class="field-row">
                <div class="checkbox-container left">
                    <input type="checkbox" data-input="showPostjudgmentCheckbox" id="showPostjudgmentCheckbox" checked>
                    <label for="showPostjudgmentCheckbox">Show postjudgment interest</label>
                </div>
                <div class="right-field">
                    <span class="label">File No.</span>
                    <span class="value">
                        <input type="text" data-input="fileNo" value="">
                    </span>
                </div>
            </div>
            
            <!-- Third row with Show per diem checkbox and Registry -->
            <div class="field-row">
                <div class="checkbox-container left">
                    <input type="checkbox" data-input="showPerDiemCheckbox" id="showPerDiemCheckbox" checked>
                    <label for="showPerDiemCheckbox">Show per diem</label>
                </div>
                <div class="right-field">
                    <span class="label bold">Registry</span>
                    <span class="value">
                        <input type="text" data-input="registry" value="Vancouver">
                    </span>
                </div>
            </div>
        </div>

        <!-- Restructured Summary Table -->
        <div class="section-title">Judgment</div>
        <table class="summary-table">             
             <tbody data-display="summaryTableBody">
                 <!-- Rows will be populated by JS -->
             </tbody>
             <tfoot>
                 <tr class="total-row">
                     <td colspan="2" class="label text-right bold" data-display="summaryTotalLabel">TOTAL AS OF</td>
                     <td class="amount text-right bold" data-display="summaryTotal"></td>
                 </tr>
                 <tr class="per-diem-row">
                     <td colspan="2" class="label text-right italic">Per Diem</td>
                     <td class="amount text-right italic" data-display="summaryPerDiem"></td>
                 </tr>
             </tfoot>
        </table>

        <!-- Wrapped Prejudgment Section -->
        <div>
            <!-- Prejudgment section header is always visible -->
            <div class="section-title">Prejudgment Interest</div>
            <!-- Restructured Prejudgment Table - only this part will be hidden -->
            <div data-display="prejudgmentSection">
                <table class="interest-table" id="prejudgmentTable">
                 <thead>
                     <!-- Updated Headers -->
                     <tr><th>Date</th><th>Description</th><th>Rate</th><th>Principal</th><th>Interest</th></tr>
                 </thead>
                 <tbody data-display="prejudgmentTableBody"></tbody>
                 <!-- Updated Footer -->
                 <tfoot>
                     <tr class="total">
                         <td colspan="3" class="text-right bold" data-display="prejudgmentTotalLabel">Total</td>
                         <td data-display="prejudgmentPrincipalTotal" class="text-right bold"></td>
                         <td data-display="prejudgmentInterestTotal" class="text-right bold"></td>
                     </tr>
                 </tfoot>
                </table>
            </div>
        </div>

        <!-- Postjudgment section -->
        <div>
            <!-- Postjudgment section header is always visible -->
            <div class="section-title">Postjudgment Interest</div>
            <!-- Restructured Postjudgment Table - only this part will be hidden -->
            <div data-display="postjudgmentSection">
                <table class="interest-table" id="postjudgmentTable">
                 <thead>
                     <!-- Updated Headers -->
                     <tr><th>Period Ending</th><th>Description</th><th>Rate</th><th>Principal</th><th>Interest</th></tr>
                 </thead>
                 <tbody data-display="postjudgmentTableBody"></tbody>
                 <!-- Updated Footer -->
                 <tfoot>
                     <tr class="total">
                         <td colspan="4" class="text-right bold">Total</td>
                         <td data-display="postjudgmentInterestTotal" class="text-right bold"></td>
                     </tr>
                 </tfoot>
                </table>
            </div>
        </div>
    </div>

    <!-- HTML Templates for Summary Table Rows -->
    <template id="summary-row-editable-pecuniary">
        <tr>
            <td class="text-left" data-display="itemLabel">
                <span data-display="itemText"></span>
                <span class="help-icon" tabindex="0" role="button" aria-label="Help" data-display="helpIcon">?
                    <span class="tooltip" data-display="tooltipText"></span>
                </span>
            </td>
            <td class="text-center">
                <input type="text" class="custom-date-input" data-input="dateValue" placeholder="YYYY-MM-DD">
            </td>
            <td class="text-right">
                <input type="text" data-input="amountValue">
            </td>
        </tr>
    </template>

    <template id="summary-row-editable-amount">
        <tr>
            <td class="text-left" data-display="itemLabel">
                <span data-display="itemText"></span>
                <span class="help-icon" tabindex="0" role="button" aria-label="Help" data-display="helpIcon">?
                    <span class="tooltip" data-display="tooltipText"></span>
                </span>
            </td>
            <td class="text-center" data-display="dateValue">
                <!-- Date is displayed, not editable -->
            </td>
            <td class="text-right">
                <input type="text" data-input="amountValue">
            </td>
        </tr>
    </template>

    <template id="summary-row-editable-date">
        <tr>
            <td class="text-left" data-display="itemLabel">
                <span data-display="itemText"></span>
                <span class="help-icon" tabindex="0" role="button" aria-label="Help" data-display="helpIcon">?
                    <span class="tooltip" data-display="tooltipText"></span>
                </span>
            </td>
            <td class="text-center">
                <input type="text" class="custom-date-input" data-input="dateValue" placeholder="YYYY-MM-DD">
            </td>
            <td class="text-right" data-display="amountValue">
                <!-- Amount is displayed, not editable -->
            </td>
        </tr>
    </template>

    <template id="summary-row-display-only">
        <tr>
            <td class="text-left" data-display="itemLabel">
                <span data-display="itemText"></span>
                <span class="help-icon" tabindex="0" role="button" aria-label="Help" data-display="helpIcon">?
                    <span class="tooltip" data-display="tooltipText"></span>
                </span>
            </td>
            <td class="text-center" data-display="dateValue"></td>
            <td class="text-right" data-display="amountValue"></td>
        </tr>
    </template>
    <!-- End of Templates -->

    <!-- Load the main script as a module -->
    <script src="calculator.js" type="module" defer></script>
</body>
</html>
