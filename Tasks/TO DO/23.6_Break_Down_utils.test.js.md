# Task 23.6: Break Down utils.test.js

## Objective

Break down the `BC COIA calculator/utils.test.js` file (currently 586 lines) into smaller, more focused test files, corresponding to the new utility files created in Task 23.5. Each new test file should be around 200-300 lines.

## Background

`utils.test.js` contains tests for all functions in the original `utils.js`. Since `utils.js` is being split into `utils.date.js` and `utils.currency.js` (Task 23.5), the corresponding tests should also be split to maintain alignment between source files and their tests.

## File to Break Down

*   `BC COIA calculator/utils.test.js` (586 lines)

## Prerequisite

*   Task 23.5 (Break Down utils.js) must be completed first, creating `utils.date.js` and `utils.currency.js`.

## Proposed New Files

Split into 2 files:

`**BC COIA calculator/utils.test.date.js**` (~300 lines)

*   Contains tests for all functions now residing in `utils.date.js`:
    *   `normalizeDate`
    *   `datesEqual`
    *   `dateBefore`
    *   `dateAfter`
    *   `dateOnOrBefore`
    *   `dateOnOrAfter`
    *   `parseDateInput`
    *   `formatDateForDisplay`
    *   `formatDateForInput`
    *   `formatDateLong`
    *   `daysBetween`
    *   `isLeap`
    *   `daysInYear`
*   Import functions from `./utils.date.js`.
*   Include necessary `vitest` imports and helper functions (like `createUTCDate`).

`**BC COIA calculator/utils.test.currency.js**` (~200 lines)

*   Contains tests for all functions now residing in `utils.currency.js`:
    *   `parseCurrency`
    *   `formatCurrencyForInput`
    *   `formatCurrencyForDisplay`
    *   (Add tests for `formatCurrencyForInputWithCommas` if not already present).
*   Import functions from `./utils.currency.js`.
*   Include necessary `vitest` imports and helper functions (like `extractText`, `checkClass`).

## Implementation Strategy

1.  Ensure Task 23.5 is complete.
2.  Create the new files: `utils.test.date.js`, `utils.test.currency.js`.
3.  Copy necessary imports (`vitest` functions, helper functions) into both new files.
4.  Move the `describe` blocks related to date functions (as listed above) from `utils.test.js` into `utils.test.date.js`. Update the import statements at the top to pull from `./utils.date.js`.
5.  Move the `describe` blocks related to currency functions (as listed above) from `utils.test.js` into `utils.test.currency.js`. Update the import statements at the top to pull from `./utils.currency.js`.
6.  Ensure all tests still pass after the refactoring (`npm test` or `npx vitest`).
7.  After confirming tests pass, delete the original `utils.test.js` file.

## Acceptance Criteria

*   `utils.test.js` is removed.
*   `utils.test.date.js` and `utils.test.currency.js` are created.
*   `utils.test.date.js` contains tests only for functions in `utils.date.js`.
*   `utils.test.currency.js` contains tests only for functions in `utils.currency.js`.
*   Each new file is around 200-300 lines.
*   All tests previously in `utils.test.js` are now in the new files, import from the correct source files, and pass successfully.