<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Special Damages Interest Calculator</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="paper">

        <h1><i>Court Order Interest Act</i> - Special Damages</h1>

        <div class="editable-fields-section">
            <div class="dates-block">
                 <!-- Input fields based on Mockup -->
                 <div class="field-pair">
                     <span class="label">Cause of Action</span>
                     <span class="value"><input type="date" data-input="causeOfActionDate" value=""></span>
                 </div>
                 <div class="field-pair">
                     <span class="label">Judgment Date</span>
                     <span class="value"><input type="date" data-input="judgmentDate" value=""></span>
                 </div>
            </div>
            <div class="right-info-block">
                 <div class="field-pair">
                     <span class="label">Jurisdiction</span>
                     <span class="value">
                         <select data-input="jurisdictionSelect">
                             <option value="BC" selected>British Columbia</option>
                             <!-- Add other jurisdictions if needed later -->
                         </select>
                     </span>
                 </div>
                 <div class="field-pair file-no-row">
                     <span class="label">File No</span>
                     <span class="value"><input type="text" data-input="fileNo" value=""></span>
                 </div>
                 <div class="field-pair registry-row">
                     <span class="label">Registry</span>
                     <span class="value"><input type="text" data-input="registry" value=""></span>
                 </div>
            </div>
        </div>

        <div class="section-title">Special Damages (Single)</div>
        <table class="input-table" id="specialDamagesInputTable">
            <thead>
                <tr>
                    <th>Date Incurred</th>
                    <th>Description</th>
                    <th class="amount-header">Amount</th>
                    <!-- Action column removed -->
                </tr>
            </thead>
            <tbody data-display="specialDamagesTbody">
                <!-- Rows will be added dynamically by JS, structure below is a template -->
                <tr>
                    <td class="date-cell">
                        <span class="editable">
                            <!-- Keep input for JS compatibility, hide visually later if needed -->
                            <input type="date" name="damageDate" class="inline-date-input">
                        </span>
                        <span class="icon date-icon">üìÖ</span>
                    </td>
                    <td>
                        <span class="editable">
                            <input type="text" name="damageDescription" class="inline-editable-input">
                        </span>
                    </td>
                    <td class="amount-cell">
                        <span class="editable">
                            <input type="text" name="damageAmount" class="inline-editable-input amount-input"> <!-- Added amount-input class -->
                        </span>
                        <span class="delete-icon">üóëÔ∏è</span>
                    </td>
                    <!-- Remove button cell removed -->
                </tr>
            </tbody>
            <!-- tfoot removed -->
        </table>
        <!-- Add button moved below table -->
        <button type="button" id="addRowBtn" class="add-button">Add Special Damages (single)</button>

        <!-- New Recurring Damages Table -->
        <div class="section-title">Special Damages (Recurring)</div>
        <table class="input-table" id="recurringDamagesInputTable">
            <thead>
                <tr>
                    <th>Date Range</th>
                    <th>Description</th>
                    <th>Amount</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody data-display="recurringDamagesTbody">
                <!-- Rows will be added dynamically by JS -->
                <tr>
                    <td class="date-range-cell">
                        <div class="date-field">
                            <span class="date-label">Start:</span>
                            <input type="date" name="recurringStartDate">
                        </div>
                        <div class="date-field">
                            <span class="date-label">End:</span>
                            <input type="date" name="recurringEndDate">
                        </div>
                    </td>
                    <td><input type="text" name="recurringDescription"></td>
                    <td class="amount-frequency-cell">
                        <input type="text" name="recurringAmount"> <!-- Changed type to text -->
                        <select name="recurringFrequency">
                            <option value="daily">Daily</option>
                            <option value="weekly">Weekly</option>
                            <option value="monthly">Monthly</option>
                            <option value="bi-annually" selected>Bi-annually</option>
                            <option value="annually">Annually</option>
                            <option value="Full Term">Full Term</option>
                        </select>
                    </td>
                    <!-- Replace button with delete icon -->
                    <td><span class="delete-icon">üóëÔ∏è</span></td>
                </tr>
            </tbody>
            <!-- tfoot removed -->
        </table>
        <!-- Add button moved below table -->
        <button type="button" id="addRecurringTableRowBtn" class="add-button">Add Special Damages (recurring)</button>

        <div class="calculate-section">
             <button type="button" id="calculateBtn">Calculate Interest</button>
        </div>
        
        <div id="calculationOutput" data-display="calculationOutputArea">
            <!-- Calculation tables will be injected here by JS -->
        </div>

        <div class="section-title">Summary</div>
        <table class="summary-table">
             <tbody>
                 <tr>
                     <td class="label">Total specials</td>
                     <td class="amount" data-display="summaryTotalSpecials">$ 0.00</td>
                 </tr>
                 <tr>
                     <td class="label">Interest on specials</td>
                     <td class="amount" data-display="summaryInterestOnSpecials">$ 0.00</td>
                 </tr>
                 <tr class="total-row">
                     <td class="label">TOTAL</td>
                     <td class="amount" data-display="summaryTotal">$ 0.00</td>
                 </tr>
             </tbody>
        </table>
    </div>

    <!-- Templates for dynamic HTML generation -->
    <template id="special-damage-row-template">
        <tr>
            <td class="date-cell">
                <span class="editable">
                    <input type="date" name="damageDate" class="inline-date-input">
                </span>
                <span class="icon date-icon">üìÖ</span>
            </td>
            <td>
                <span class="editable">
                    <input type="text" name="damageDescription" class="inline-editable-input">
                </span>
            </td>
            <td class="amount-cell">
                <span class="editable">
                    <input type="text" name="damageAmount" class="inline-editable-input amount-input">
                </span>
                <span class="delete-icon">üóëÔ∏è</span>
            </td>
        </tr>
    </template>

    <template id="recurring-damage-row-template">
        <tr>
            <td class="date-range-cell">
                <div class="date-field">
                    <span class="date-label">Start:</span>
                    <input type="date" name="recurringStartDate">
                </div>
                <div class="date-field">
                    <span class="date-label">End:</span>
                    <input type="date" name="recurringEndDate">
                </div>
            </td>
            <td><input type="text" name="recurringDescription"></td>
            <td class="amount-frequency-cell">
                <input type="text" name="recurringAmount">
                <select name="recurringFrequency">
                    <option value="daily">Daily</option>
                    <option value="weekly">Weekly</option>
                    <option value="monthly">Monthly</option>
                    <option value="bi-annually" selected>Bi-annually</option>
                    <option value="annually">Annually</option>
                    <option value="Full Term">Full Term</option>
                </select>
            </td>
            <td><span class="delete-icon">üóëÔ∏è</span></td>
        </tr>
    </template>

    <template id="period-calculation-template">
        <div class="period-calculation">
            <div class="period-header"><strong></strong></div>
            <div class="period-details"></div>
            <table class="output-table">
                <thead>
                    <tr><th>Date</th><th>Description</th><th>Amount</th><th>Interest</th></tr>
                </thead>
                <tbody></tbody>
                <tfoot>
                    <tr class="subtotal">
                        <td></td>
                        <td><strong>Subtotal</strong></td>
                        <td class="text-right"><strong></strong></td>
                        <td class="text-right"><strong></strong></td>
                    </tr>
                </tfoot>
            </table>
        </div>
    </template>

    <template id="period-carryover-row-template">
        <tr>
            <td></td>
            <td>Carry over</td>
            <td class="text-right"></td>
            <td class="text-right"></td>
        </tr>
    </template>

    <template id="period-damage-row-template">
        <tr>
            <td></td>
            <td></td>
            <td class="text-right"></td>
            <td></td>
        </tr>
    </template>

    <template id="period-interest-detail-row-template">
        <tr class="interest-detail-row">
            <td></td>
            <td></td>
            <td></td>
            <td class="text-right"></td>
        </tr>
    </template>

    <!-- Load the default values first, then the main calculator script -->
    <script src="defaultValues.js" type="module" defer></script>
    <script src="calculator.js" type="module" defer></script>

</body>
</html>
